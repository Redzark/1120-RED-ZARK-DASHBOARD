<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1120 KVK TIMELINE</title>
    <style>
        /* ============================
           ìŠ¤íƒ€ì¼ (Design System)
           ============================ */
        :root {
            --bg-color: #0f1219;
            --card-bg: #1e2330;
            --text-primary: #f0f0f0;
            --text-secondary: #a0a5b9;
            --accent-gold: #ffb347;
            --ruins-color: #4fc3f7; 
            --altar-color: #ba68c8;
            --war-color: #e57373;
            --timer-bg: #2d3342;
        }

        body {
            font-family: 'Segoe UI', 'Noto Sans KR', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        h1 {
            color: var(--accent-gold);
            letter-spacing: 2px;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .server-time {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-family: monospace;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* ì•„ì½”ë””ì–¸ ìŠ¤íƒ€ì¼ */
        details {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #333;
            transition: all 0.3s ease;
        }

        details[open] {
            border-color: #555;
            padding-bottom: 15px;
        }

        summary {
            padding: 15px 20px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.05);
            list-style: none; /* í™”ì‚´í‘œ ì œê±° (ì»¤ìŠ¤í…€ ìœ„í•¨) */
        }
        
        summary::-webkit-details-marker { display: none; }

        summary:hover { background-color: rgba(255, 255, 255, 0.1); }

        summary::after {
            content: 'â–¼';
            font-size: 0.8em;
            color: var(--text-secondary);
            transition: transform 0.3s;
        }

        details[open] summary::after { transform: rotate(180deg); }

        /* ì„¹ì…˜ë³„ ìƒ‰ìƒ ë  */
        .section-war summary { border-left: 5px solid var(--war-color); }
        .section-ruins summary { border-left: 5px solid var(--ruins-color); }
        .section-altar summary { border-left: 5px solid var(--altar-color); }

        /* ë‚´ë¶€ ì½˜í…ì¸  */
        .content-box {
            padding: 0 15px;
            text-align: left;
        }

        /* ë„¥ìŠ¤íŠ¸ ì¹´ìš´íŠ¸ë‹¤ìš´ ë°•ìŠ¤ */
        .next-event-box {
            background-color: var(--timer-bg);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            border: 1px solid #444;
        }
        .next-label { font-size: 0.9em; color: var(--accent-gold); margin-bottom: 5px; }
        .next-timer { font-size: 1.5em; font-weight: bold; font-family: monospace; }
        .next-title { font-size: 1.1em; margin-bottom: 5px; color: white; }

        /* ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìŠ¤íƒ€ì¼ */
        .list-item {
            background: rgba(0,0,0,0.2);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 5px;
            font-size: 0.9em;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .list-item.active { border: 1px solid var(--accent-gold); background: rgba(255, 179, 71, 0.1); }
        
        .row-header { display: flex; justify-content: space-between; color: var(--text-primary); font-weight: bold; }
        .row-time { display: flex; justify-content: space-between; font-family: monospace; color: var(--text-secondary); font-size: 0.85em; }
        
        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 500px) {
            .row-time { flex-direction: column; gap: 2px; }
        }
    </style>
</head>
<body>

    <h1>1120 KVK TIMELINE</h1>
    <div class="server-time" id="current-time-display">Loading time...</div>

    <div class="container">

        <details class="section-war" open>
            <summary>ğŸš© Major Milestones (ì£¼ìš” ì¼ì •)</summary>
            <div class="content-box" id="milestone-list">
                </div>
        </details>

        <details class="section-ruins">
            <summary>ğŸ›ï¸ Ancient Ruins (ê³ ëŒ€ ìœ ì )</summary>
            <div class="content-box">
                <div id="ruins-next-box" class="next-event-box" style="display:none;">
                    <div class="next-label">NEXT RUINS IN</div>
                    <div class="next-title" id="ruins-next-title">-</div>
                    <div class="next-timer" id="ruins-next-timer">00:00:00</div>
                </div>
                <div id="ruins-list"></div>
            </div>
        </details>

        <details class="section-altar">
            <summary>ğŸ”¥ Dark Altar (ì–´ë‘ ì˜ ì œë‹¨)</summary>
            <div class="content-box">
                <div id="altar-next-box" class="next-event-box" style="display:none;">
                    <div class="next-label">NEXT ALTAR IN</div>
                    <div class="next-title" id="altar-next-title">-</div>
                    <div class="next-timer" id="altar-next-timer">00:00:00</div>
                </div>
                <div id="altar-list"></div>
            </div>
        </details>

    </div>

    <script>
        // =========================================================
        // ğŸ‘‡ [ì„¤ì • êµ¬ì—­] ì´ ë¶€ë¶„ì˜ ë‚ ì§œë§Œ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤!
        // =========================================================
        const config = {
            // 1. ê³ ì • ì¼ì • (ê´€ë¬¸ ë“±)
            milestones: [
                { title: "ìƒì–´ë²„ë¦° ì™•êµ­ ì˜¤í”ˆ", date: "2025-12-09T09:00:00" },
                { title: "4ë ˆë²¨ ê´€ë¬¸ ì˜¤í”ˆ", date: "2025-12-13T12:00:00" },
                { title: "5ë ˆë²¨ ê´€ë¬¸ ì˜¤í”ˆ", date: "2025-12-27T12:00:00" },
                { title: "í‚¹ìŠ¤ëœë“œ (7ë ˆë²¨ ê´€ë¬¸)", date: "2026-01-08T12:00:00" },
                { title: "KvK ì‹œì¦Œ ì¢…ë£Œ", date: "2026-01-28T09:00:00" }
            ],
            // 2. íí—ˆ (40ì‹œê°„ ê°„ê²©, 28íšŒ) - ì²« ì‹œì‘ì¼ ì…ë ¥
            ruins: {
                start: "2025-12-17T09:00:00", 
                interval: 40,
                count: 28
            },
            // 3. ì œë‹¨ (86ì‹œê°„ ê°„ê²©, 10íšŒ) - ì²« ì‹œì‘ì¼ ì…ë ¥
            altar: {
                start: "2025-12-20T09:00:00",
                interval: 86,
                count: 10
            }
        };
        // =========================================================

        function formatTime(date) {
            const kst = date.toLocaleString('en-US', { timeZone: 'Asia/Seoul', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', hour12: false });
            const utc = date.toLocaleString('en-US', { timeZone: 'UTC', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', hour12: false });
            return { kst, utc };
        }

        function getTimeRemaining(endtime) {
            const total = Date.parse(endtime) - Date.parse(new Date());
            const seconds = Math.floor((total / 1000) % 60);
            const minutes = Math.floor((total / 1000 / 60) % 60);
            const hours = Math.floor((total / (1000 * 60 * 60)) % 24);
            const days = Math.floor(total / (1000 * 60 * 60 * 24));
            return { total, days, hours, minutes, seconds };
        }

        // ë°˜ë³µ ì´ë²¤íŠ¸ ìƒì„±ê¸° (ì§€ë‚œ ê²ƒ í•„í„°ë§)
        function generateRepeatingEvents(cfg, nameKr, nameEn) {
            const list = [];
            const now = new Date();
            // ìœ ì§€ ì‹œê°„ (ì´ë²¤íŠ¸ê°€ ì§„í–‰ì¤‘ì¸ ì‹œê°„). íí—ˆëŠ” ì•½ 1ì‹œê°„, ì œë‹¨ì€ ì•½ 1~2ì‹œê°„ ì¡ìŒ.
            // ì—¬ê¸°ì„œëŠ” 'ì‹œì‘ ì‹œê°„'ì´ ì§€ë‚¬ìœ¼ë©´ ë¦¬ìŠ¤íŠ¸ì—ì„œ ëº„ì§€, ì§„í–‰ì¤‘ì´ë©´ ë‚¨ê¸¸ì§€ ê²°ì •.
            // ìš”ì²­ì‚¬í•­: "ì§€ë‚œíšŒì°¨ëŠ” ì‚¬ë¼ì¡Œìœ¼ë©´" -> ì‹œì‘ì‹œê°„ ê¸°ì¤€ ê³¼ê±°ë©´ ì‚­ì œ.
            
            const startDate = new Date(cfg.start);

            for (let i = 0; i < cfg.count; i++) {
                const evtDate = new Date(startDate.getTime() + (i * cfg.interval * 60 * 60 * 1000));
                
                // ì´ë²¤íŠ¸ ì‹œì‘ ì‹œê°„ì´ í˜„ì¬ë³´ë‹¤ ë¯¸ë˜ì¸ ê²½ìš°ì—ë§Œ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
                // (ì•½ê°„ì˜ ì—¬ìœ ë¥¼ ìœ„í•´ ì‹œì‘ í›„ 1ì‹œê°„ ì´ë‚´ë¼ë©´ 'ì§„í–‰ì¤‘'ìœ¼ë¡œ í‘œì‹œí•˜ê¸° ìœ„í•´ ë‚¨ê¸¸ ìˆ˜ë„ ìˆìŒ. ì—¬ê¸°ì„  ì¹¼ê°™ì´ ë¯¸ë˜ë§Œ ë‚¨ê¹€)
                if (evtDate > now - (1000 * 60 * 60)) { // 1ì‹œê°„ ì „ê¹Œì§€ëŠ” ë¦¬ìŠ¤íŠ¸ì— í‘œì‹œ (ì§„í–‰ì¤‘ì¼ìˆ˜ìˆìœ¼ë‹ˆ)
                    list.push({
                        index: i + 1,
                        title: `${nameKr} #${i + 1} (${nameEn})`,
                        date: evtDate
                    });
                }
            }
            return list;
        }

        function renderMilestones() {
            const container = document.getElementById('milestone-list');
            container.innerHTML = '';
            const now = new Date();

            config.milestones.forEach(evt => {
                const d = new Date(evt.date);
                const times = formatTime(d);
                let status = "";
                let badge = "";

                if (d < now) {
                    status = "past"; // CSSì—ì„œ íë¦¬ê²Œ ì²˜ë¦¬í•˜ê±°ë‚˜ ìˆ¨ê¹€ (ì£¼ìš” ì¼ì •ì€ ê¸°ë¡ìš©ìœ¼ë¡œ íë¦¬ê²Œ ë‚¨ê¸°ëŠ”ê²Œ ì¢‹ìŒ)
                    badge = "âœ… END";
                } else {
                    const diffDays = Math.ceil((d - now) / (1000 * 60 * 60 * 24));
                    badge = diffDays === 1 ? "ğŸ”¥ D-Day" : `D-${diffDays}`;
                }

                // ì£¼ìš” ì¼ì •ì€ ì§€ë‚˜ë„ ë‚¨ê²¨ë‘  (íˆìŠ¤í† ë¦¬ìš©), ì›í•˜ë©´ if(d<now) return; ìœ¼ë¡œ ì‚­ì œ ê°€ëŠ¥
                const opacity = status === "past" ? "0.5" : "1";
                
                const html = `
                    <div class="list-item" style="opacity: ${opacity}">
                        <div class="row-header">
                            <span>${evt.title}</span>
                            <span style="color:var(--accent-gold)">${badge}</span>
                        </div>
                        <div class="row-time">
                            <span>ğŸ‡°ğŸ‡· ${times.kst}</span>
                            <span>ğŸŒ ${times.utc} (UTC)</span>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function renderRepeatingSection(type, listId, nextBoxId, nextTitleId, nextTimerId) {
            const container = document.getElementById(listId);
            const nextBox = document.getElementById(nextBoxId);
            container.innerHTML = '';
            
            let events = [];
            if (type === 'ruins') events = generateRepeatingEvents(config.ruins, "ê³ ëŒ€ ìœ ì ", "Ruins");
            else events = generateRepeatingEvents(config.altar, "ì–´ë‘ ì˜ ì œë‹¨", "Altar");

            if (events.length === 0) {
                container.innerHTML = '<div style="padding:10px; color:#666;">All events completed.</div>';
                nextBox.style.display = 'none';
                return;
            }

            // ê°€ì¥ ê°€ê¹Œìš´ ë‹¤ìŒ ì´ë²¤íŠ¸ (ë°°ì—´ì˜ 0ë²ˆì§¸ê°€ ë¨, ìœ„ì—ì„œ í•„í„°ë§ í–ˆìœ¼ë¯€ë¡œ)
            const nextEvent = events[0];
            const now = new Date();

            // Next Box ì—…ë°ì´íŠ¸
            nextBox.style.display = 'block';
            document.getElementById(nextTitleId).innerText = nextEvent.title;
            
            const t = getTimeRemaining(nextEvent.date);
            if (t.total <= 0) {
                 document.getElementById(nextTimerId).innerText = "OPEN NOW!";
                 document.getElementById(nextTimerId).style.color = "#00e676";
            } else {
                // ì‹œ:ë¶„:ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´
                const formatted = `${t.days > 0 ? t.days + 'd ' : ''}${('0'+t.hours).slice(-2)}:${('0'+t.minutes).slice(-2)}:${('0'+t.seconds).slice(-2)}`;
                document.getElementById(nextTimerId).innerText = formatted;
                document.getElementById(nextTimerId).style.color = "white";
            }

            // ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ (ë‹¤ìŒê²ƒ í¬í•¨ ë‚˜ë¨¸ì§€ ë¯¸ë˜ ì¼ì •ë“¤)
            events.forEach((evt, idx) => {
                const times = formatTime(evt.date);
                const isNext = (idx === 0);
                const activeClass = isNext ? "active" : "";
                
                const html = `
                    <div class="list-item ${activeClass}">
                        <div class="row-header">
                            <span>${evt.title}</span>
                        </div>
                        <div class="row-time">
                            <span>ğŸ‡°ğŸ‡· ${times.kst}</span>
                            <span>ğŸŒ ${times.utc}</span>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function updateAll() {
            // í˜„ì¬ ì‹œê°„ í‘œì‹œ
            const now = new Date();
            document.getElementById('current-time-display').innerText = 
                `Current: ${now.toLocaleString('en-US', {timeZone: 'Asia/Seoul', hour12:false})} (KST)`;

            // ë Œë”ë§
            renderMilestones();
            renderRepeatingSection('ruins', 'ruins-list', 'ruins-next-box', 'ruins-next-title', 'ruins-next-timer');
            renderRepeatingSection('altar', 'altar-list', 'altar-next-box', 'altar-next-title', 'altar-next-timer');
        }

        // ì´ˆê¸° ì‹¤í–‰ ë° 1ì´ˆë§ˆë‹¤ ê°±ì‹  (ì¹´ìš´íŠ¸ë‹¤ìš´ ìœ„í•´)
        updateAll();
        setInterval(updateAll, 1000);

    </script>
</body>
</html>
